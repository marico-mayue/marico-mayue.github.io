<!doctype html>



  


<html class="theme-next pisces use-motion">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/images/avatar.png?v=5.0.1">






<meta name="description" content="Front-End Developer">
<meta property="og:type" content="website">
<meta property="og:title" content="MaYue&#39;s Notes">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="MaYue&#39;s Notes">
<meta property="og:description" content="Front-End Developer">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MaYue&#39;s Notes">
<meta name="twitter:description" content="Front-End Developer">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/page/2/">

  <title> MaYue's Notes </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">MaYue's Notes</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Quick notes</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input">
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', '我的博客笔记','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/14/Axios：基于Promise的HTTP库/" itemprop="url">
                  Axios：基于Promise的HTTP库
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-04-14T00:00:00+08:00" content="2017-04-14">
              2017-04-14
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/HTTP库/" itemprop="url" rel="index">
                    <span itemprop="name">HTTP库</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/04/14/Axios：基于Promise的HTTP库/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/04/14/Axios：基于Promise的HTTP库/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在Vue1.0中我们知道和服务端通信发送请求获取数据依赖的是vue-resource，但自Vue更新到2.0之后，作者就宣告不再对vue-resource更新，而是改成了推荐的Axios这一HTTP库。作用上类似我们熟知的一些Ajax库，但是Axios是基于Promise的HTTP请求客户端，可同时在浏览器和Node.js中使用，这好像更符合目前前端的技术新趋势。现将Axios的官方文档及示例做一介绍。</p>
<h4 id="实现的功能特点"><a href="#实现的功能特点" class="headerlink" title="实现的功能特点"></a>实现的功能特点</h4><ul>
<li>可以从浏览器端发起XMLHttpRequests请求</li>
<li>node端发起http请求</li>
<li>支持Promise API</li>
<li>监听请求和响应</li>
<li>转化请求和返回响应数据</li>
<li>取消请求</li>
<li>JSON数据自动转化</li>
<li>客户端支持防御<a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery" target="_blank" rel="noopener">CSRF</a>攻击</li>
</ul>
<h4 id="浏览器支持"><a href="#浏览器支持" class="headerlink" title="浏览器支持"></a>浏览器支持</h4><table>
<thead>
<tr>
<th><img src="https://raw.github.com/alrra/browser-logos/master/src/chrome/chrome_48x48.png" alt="Chrome"></th>
<th><img src="https://raw.github.com/alrra/browser-logos/master/src/firefox/firefox_48x48.png" alt="Firefox"></th>
<th><img src="https://raw.github.com/alrra/browser-logos/master/src/safari/safari_48x48.png" alt="Safari"></th>
<th><img src="https://raw.github.com/alrra/browser-logos/master/src/opera/opera_48x48.png" alt="Opera"></th>
<th><img src="https://raw.github.com/alrra/browser-logos/master/src/edge/edge_48x48.png" alt="Edge"></th>
<th><img src="https://raw.github.com/alrra/browser-logos/master/src/archive/internet-explorer_9-11/internet-explorer_9-11_48x48.png" alt="IE"></th>
</tr>
</thead>
<tbody>
<tr>
<td>Latest ✔</td>
<td>Latest ✔</td>
<td>Latest ✔</td>
<td>Latest ✔</td>
<td>Latest ✔</td>
<td>8+ ✔</td>
<td></td>
</tr>
</tbody>
</table>
<p><a href="https://saucelabs.com/u/axios" target="_blank" rel="noopener"><img src="https://saucelabs.com/open_sauce/build_matrix/axios.svg" alt="Browser Matrix"></a></p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><h5 id="使用npm"><a href="#使用npm" class="headerlink" title="使用npm"></a>使用npm</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install axios</span><br></pre></td></tr></table></figure>
<h5 id="使用bower"><a href="#使用bower" class="headerlink" title="使用bower"></a>使用bower</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bower install axios</span><br></pre></td></tr></table></figure>
<h5 id="使用CDN"><a href="#使用CDN" class="headerlink" title="使用CDN"></a>使用CDN</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;https://unpkg.com/axios/dist/axios.min.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><h5 id="发起一个GET请求"><a href="#发起一个GET请求" class="headerlink" title="发起一个GET请求"></a>发起一个GET请求</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 发起一个user请求</span><br><span class="line">axios.get(&apos;/user?ID=1234&apos;)</span><br><span class="line">.then(function(respone) &#123;</span><br><span class="line">    console.log(response);</span><br><span class="line">&#125;)</span><br><span class="line">.catch(function(error) &#123;</span><br><span class="line">    console.log(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 上面的请求也可选择下面的方式来写</span><br><span class="line">axios.get(&apos;/user&apos;,&#123;</span><br><span class="line">    params:&#123;</span><br><span class="line">        ID:12345</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">.then(function(response)&#123;</span><br><span class="line">    console.log(response);</span><br><span class="line">&#125;)</span><br><span class="line">.catch(function(error)&#123;</span><br><span class="line">    console.log(error)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="发起一个POST请求"><a href="#发起一个POST请求" class="headerlink" title="发起一个POST请求"></a>发起一个POST请求</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">axios.post(&apos;/user&apos;, &#123;</span><br><span class="line">    firstName: &apos;Fred&apos;,</span><br><span class="line">    lastName: &apos;Flintstone&apos;</span><br><span class="line">&#125;)</span><br><span class="line">.then(function (response) &#123;</span><br><span class="line">  	console.log(response);</span><br><span class="line">&#125;)</span><br><span class="line">.catch(function (error) &#123;</span><br><span class="line">    console.log(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="发起一个多重并发请求"><a href="#发起一个多重并发请求" class="headerlink" title="发起一个多重并发请求"></a>发起一个多重并发请求</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function getUserAccount() &#123;</span><br><span class="line">    return axios.get(&apos;/user/12345&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getUserPermissions() &#123;</span><br><span class="line">    return axios.get(&apos;/user/12345/permissions&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">axios.all([getUerAccount(),getUserPermissions()])</span><br><span class="line">.then(axios.spread(function(acc,pers)&#123;</span><br><span class="line">    // 两个请求现在都完成</span><br><span class="line">	// TODO</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<h3 id="Axios-API"><a href="#Axios-API" class="headerlink" title="Axios API"></a>Axios API</h3><p>axios能够在进行请求时进行一些设置。</p>
<p><strong>axios(config)</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 发起POST请求</span><br><span class="line">axios(&#123;</span><br><span class="line">    method: &apos;post&apos;,</span><br><span class="line">    url: &apos;/user/12345&apos;,</span><br><span class="line">    data:&#123;</span><br><span class="line">        firstName:&apos;Fred&apos;,</span><br><span class="line">        lastName:&apos;Flintstone&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 请求远程服务的一张图片</span><br><span class="line">axios(&#123;</span><br><span class="line">  method: &apos;get&apos;,</span><br><span class="line">  url: &apos;http://bit.ly/2mTM3nY&apos;,</span><br><span class="line">  responseType: &apos;stream&apos;</span><br><span class="line">&#125;)</span><br><span class="line">.then(function(response) &#123;</span><br><span class="line">    response.data.pipe(fs.createWriteStream(&apos;ada_lovelace.jpg&apos;))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>axios(url[, config])</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 发起一个GET请求</span><br><span class="line">axios(&apos;/user/12345/);</span><br></pre></td></tr></table></figure>
<h3 id="请求方法别名"><a href="#请求方法别名" class="headerlink" title="请求方法别名"></a>请求方法别名</h3><p>为了方便axios提供了所有请求方法的别名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.request(config)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.get(url[, config])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.delete(url[, config])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.head(url[, config])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.options(url[, config])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.post(url[, data[, config]])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.put(url[, data[, config]])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.patch(url[, data[, config]])</span><br></pre></td></tr></table></figure>
<h5 id="并发"><a href="#并发" class="headerlink" title="并发"></a>并发</h5><p>处理并发请求有用的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.all(iterable)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.spread(callback)</span><br></pre></td></tr></table></figure>
<h4 id="创建一个实例"><a href="#创建一个实例" class="headerlink" title="创建一个实例"></a>创建一个实例</h4><p>你可以使用自定义设置创建一个新的实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.create([config])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var instance = axios.create(&#123;</span><br><span class="line">  baseURL: &apos;https://some-domain.com/api/&apos;,</span><br><span class="line">  timeout: 1000,</span><br><span class="line">  headers: &#123;&apos;X-Custom-Header&apos;: &apos;foobar&apos;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="请求配置"><a href="#请求配置" class="headerlink" title="请求配置"></a>请求配置</h3><p>以下列出了一些请求时的设置。只有url是必须的，如果没有指明的话，默认的请求方法是GET。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    // url 是服务器链接接口地址</span><br><span class="line">    url: &apos;/user&apos;,</span><br><span class="line"></span><br><span class="line">    // method 是发起请求时的请求方法</span><br><span class="line">    method: &apos;get&apos;,</span><br><span class="line"></span><br><span class="line">    // baseURL 如果url不是绝对地址，那么将会加在其前面</span><br><span class="line">    // 当axios使用相对地址时这个设置非常方便</span><br><span class="line">    // 在其实例中的方法</span><br><span class="line">    baseURL: &apos;http://some-domain.com/api/&apos;,</span><br><span class="line"></span><br><span class="line">    // transformRequest 允许请求的数据在传到服务器之前进行转化</span><br><span class="line">    // 这个只适用于PUT,GET,PATCH方法</span><br><span class="line">    // 数组中的最后一个函数必须返回一个字符串，一个ArrayBuffer，或者Stream</span><br><span class="line">    transformRequest: [function(data) &#123;</span><br><span class="line">        // 依自己的需求对请求数据进行处理</span><br><span class="line">        return data;</span><br><span class="line">    &#125;],</span><br><span class="line"></span><br><span class="line">    // transformResponse 允许返回的数据传入then/catch之前进行处理</span><br><span class="line">    transformResponse: [function(data) &#123;</span><br><span class="line">        // 依需要对数据进行处理</span><br><span class="line">        return data;</span><br><span class="line">    &#125;],</span><br><span class="line"></span><br><span class="line">    // headers 是自定义的要被发送的头信息</span><br><span class="line">    headers: &#123;&apos;X-Requested-with&apos;: &apos;XMLHttpRequest&apos;&#125;,</span><br><span class="line"></span><br><span class="line">    // params是请求连接中的请求参数，必须是一个纯对象，或者URLSearchParams对象</span><br><span class="line">    params: &#123;</span><br><span class="line">        ID: 12345</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    // paramsSerializer 是一个可选的函数，是用来序列化参数</span><br><span class="line">    // 例如：（https://ww.npmjs.com/package/qs,http://api.jquery.com/jquery.param/)</span><br><span class="line">    paramsSerializer: function(params) &#123;</span><br><span class="line">        return Qs.stringify(params,&#123;arrayFormat: &apos;brackets&apos;&#125;)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // data 是请求体需要设置的数据</span><br><span class="line">    // 只适用于应用的PUT，POST，PATCH请求方法</span><br><span class="line">    // 当没有设置transformRequest时，必须是以下其中之一的类型：</span><br><span class="line">    // -string,plain object,ArrayBuffer,ArrayBufferView,URLSearchParams</span><br><span class="line">    // -仅浏览器：FormData,File,Blob</span><br><span class="line">    // -仅Node：Stream</span><br><span class="line">    data: &#123;</span><br><span class="line">        firstName: &apos;fred&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    // timeout 定义请求的时间，单位是毫秒。</span><br><span class="line">    // 如果请求的时间超过这个设定时间，请求将会停止</span><br><span class="line">    timeout: 1000,</span><br><span class="line">    </span><br><span class="line">    // withCredentials 表明是否跨域请求，</span><br><span class="line">    // 应该是用证书</span><br><span class="line">    withCredentials: false // 默认值</span><br><span class="line"></span><br><span class="line">    // adapter 适配器，允许自定义处理请求，这会使测试更简单</span><br><span class="line">    // 返回一个promise，并且提供验证返回</span><br><span class="line">    adapter: function(config) &#123;</span><br><span class="line">		</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // auth 表明HTTP基础的认证应该被使用，并且提供证书</span><br><span class="line">    // 这个会设置一个authorization头（header），并且覆盖你在header设置的Authorization头信息</span><br><span class="line">    auth: &#123;</span><br><span class="line">        username: &apos;janedoe&apos;,</span><br><span class="line">        password: &apos;s00pers3cret&apos;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // responsetype 表明服务器返回的数据类型，这些类型的设置应该是：</span><br><span class="line">    //&apos;arraybuffer&apos;,&apos;blob&apos;,&apos;document&apos;,&apos;json&apos;,&apos;text&apos;,stream&apos;</span><br><span class="line">    responsetype: &apos;json&apos;,</span><br><span class="line"></span><br><span class="line">    // xsrfHeaderName 是http头（header）的名字，并且该头携带xsrf的值</span><br><span class="line">    xrsfHeadername: &apos;X-XSRF-TOKEN&apos;，// 默认值</span><br><span class="line"></span><br><span class="line">    // onUploadProgress允许处理上传过程的事件</span><br><span class="line">    onUploadProgress: function(progressEvent)&#123;</span><br><span class="line">        //本地过程事件发生时想做的事</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    //`onDownloadProgress`允许处理下载过程的事件</span><br><span class="line">    onDownloadProgress: function(progressEvent) &#123;</span><br><span class="line">        // 下载过程中想做的事</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // maxContentLength 定义http返回内容的最大容量</span><br><span class="line">    maxContentLength: 2000,</span><br><span class="line"></span><br><span class="line">    // validateStatus 定义promise的resolve和reject</span><br><span class="line">    // http返回状态码，如果validateStatus返回true（或者设置成null/undefined），promise将会接受；其他的promise将会拒绝。</span><br><span class="line">    validateStatus: function(status) &#123;</span><br><span class="line">        return status &gt;= 200 &amp;&amp; stauts &lt; 300; // 默认</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // httpAgent和httpsAgent当产生一个http或者https请求时分别定义一个自定义的代理，在nodejs中。</span><br><span class="line">    // 这个允许设置一些选选个，像是`keepAlive`--这个在默认中是没有开启的。</span><br><span class="line">    httpAgent: new http.Agent(&#123;keepAlive: treu&#125;),</span><br><span class="line">    httpsAgent: new https.Agent(&#123;keepAlive: true&#125;),</span><br><span class="line"></span><br><span class="line">    // proxy 定义服务器的主机名字和端口号</span><br><span class="line">    // auth表明HTTP基本认证应该跟proxy相连接，并且提供证书</span><br><span class="line">    // 这个将设置一个&apos;Proxy-Authorization&apos;头(header)，覆盖原先自定义的</span><br><span class="line">    proxy: &#123;</span><br><span class="line">        host: 127.0.0.1,</span><br><span class="line">        port: 9000,</span><br><span class="line">        auth: &#123;</span><br><span class="line">            username: &apos;cdd&apos;,</span><br><span class="line">            password: &apos;123456&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // cancelTaken定义一个取消，能够用来取消请求</span><br><span class="line">    //（查看下面的Cancellation的详细部分）</span><br><span class="line">    cancelToke: new CancelToken(function(cancel) &#123;</span><br><span class="line">    </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="响应概要"><a href="#响应概要" class="headerlink" title="响应概要"></a>响应概要</h3><p>一个请求的响应包含以下信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    // data是服务器的提供的返回值</span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">    // status是服务器返回的http状态码</span><br><span class="line">    status: 200,</span><br><span class="line"></span><br><span class="line">    // statusText是服务器返回的http状态信息</span><br><span class="line">    statusText: &apos;ok&apos;,</span><br><span class="line"></span><br><span class="line">    // headers是服务器返回中携带的headers</span><br><span class="line">    headers: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">    // config是对axios进行的设置，目的是为了请求</span><br><span class="line">    config: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果你使用<strong>then</strong>，你将获取到以下响应返回结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">axios.get(&apos;/user/12345&apos;)</span><br><span class="line">  .then(function(response) &#123;</span><br><span class="line">    console.log(response.data);</span><br><span class="line">    console.log(response.status);</span><br><span class="line">    console.log(response.statusText);</span><br><span class="line">    console.log(response.headers);</span><br><span class="line">    console.log(response.config);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p>使用catch时，或者传入一个reject callback作为then的第二个参数，那么返回的错误信息将能够被使用。</p>
<h4 id="默认设置"><a href="#默认设置" class="headerlink" title="默认设置"></a>默认设置</h4><p>你可以设置一个默认的设置将在所有的请求中有效。</p>
<h6 id="全局默认设置："><a href="#全局默认设置：" class="headerlink" title="全局默认设置："></a>全局默认设置：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.baseURL = &apos;https://api.example.com&apos;;</span><br><span class="line">axios.defaults.headers.common[&apos;Authorization&apos;] = AUTH_TOKEN;</span><br><span class="line">axios.defaults.headers.post[&apos;Content-Type&apos;] = &apos;application/x-www-form-urlencoded&apos;;</span><br></pre></td></tr></table></figure>
<h6 id="实例中自定义默认值"><a href="#实例中自定义默认值" class="headerlink" title="实例中自定义默认值"></a>实例中自定义默认值</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 当创建一个实例时进行默认设置</span><br><span class="line">var instance = axios.create(&#123;</span><br><span class="line">    baseURL: &apos;https://api.example.com&apos;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 在实例创建之后改变默认值</span><br><span class="line">instance.defaults.headers.common[&apos;Authorization&apos;] = AUTH_TOKEN;</span><br></pre></td></tr></table></figure>
<h6 id="设置优先级"><a href="#设置优先级" class="headerlink" title="设置优先级"></a>设置优先级</h6><p>设置(config)将按照优先顺序整合起来。首先的是在 lib/defaults.js 中定义的默认设置，其次是 defaults 实例属性的设置，最后是请求中 config 参数的设置。越往后面的等级越高，会覆盖前面的设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 使用默认库的设置创建一个实例，</span><br><span class="line">// 这个实例中使用的是默认库的timeout设置，默认值是0。</span><br><span class="line">var instance = axios.create();</span><br><span class="line"></span><br><span class="line">// 覆盖默认库中timeout的默认值</span><br><span class="line">// 此时所有的请求的timeout时间是2.5秒</span><br><span class="line">instance.defaults.timeout = 2500;</span><br><span class="line"></span><br><span class="line">// 覆盖该次请求中timeout的值，这个值设置的时间更长一些</span><br><span class="line">instance.get(&apos;/longRequest&apos;,&#123;</span><br><span class="line">    timeout: 5000</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h6 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h6><p>你可以在requests或者responses被then或者catch处理之前对他们进行拦截</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 添加一个请求拦截器</span><br><span class="line">axios.interceptors.request.use(function(config) &#123;</span><br><span class="line">    // 在请求发送之前</span><br><span class="line">    // TODO</span><br><span class="line">    return config;</span><br><span class="line">&#125;,function(error) &#123;</span><br><span class="line">    // 当出现请求错误</span><br><span class="line">    // TODO</span><br><span class="line">    return Promise.reject(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 添加一个返回拦截器</span><br><span class="line">axios.interceptors.response.use(function(response) &#123;</span><br><span class="line">    // 对返回的数据进行处理</span><br><span class="line">    // TODO</span><br><span class="line">    return response;</span><br><span class="line">&#125;,function(error) &#123;</span><br><span class="line">    // 对返回的错误进行处理</span><br><span class="line">    //TODO</span><br><span class="line">    return Promise.reject(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>如果你需要在稍后移除拦截器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var myInterceptor = axios.interceptors.request.use(function()&#123;/*...*/&#125;);</span><br><span class="line">axios.interceptors.rquest.eject(myInterceptor);</span><br></pre></td></tr></table></figure>
<p>你可以在一个axios实例中使用拦截器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var instance = axios.create();</span><br><span class="line">instance.interceptors.request.use(function()&#123;/*...*/&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">axios.get(&apos;user/12345&apos;)</span><br><span class="line">.catch(function(error) &#123;</span><br><span class="line">    if (error.response) &#123;</span><br><span class="line">        console.log(error.response.data);</span><br><span class="line">        console.log(error.response.status);</span><br><span class="line">        console.log(error.response.headers);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        // 一些错误是在设置请求时触发的</span><br><span class="line">        console.log(&apos;Error&apos;, error.message);</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(error.config);</span><br><span class="line">&#125;);</span><br><span class="line">```        </span><br><span class="line"></span><br><span class="line">可以使用validateStatus设置选项自定义HTTP状态码的错误范围。</span><br></pre></td></tr></table></figure>
<p>axios.get(‘user/12345’,{<br>    validateStatus:function(status){<br>        return status &lt; 500; // Reject only if the status code is greater than or equal to 500<br>    }<br>});<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 取消请求</span><br><span class="line"></span><br><span class="line">可以使用cancel token取消一个请求。</span><br><span class="line"></span><br><span class="line">可以使用CancelToke.source工厂函数创建一个cancel token：</span><br></pre></td></tr></table></figure></p>
<p>var source = CancelToken.source();</p>
<p>axios.get(‘/user/12345’, {<br>    cancelToken:source.toke<br>}).catch(function(thrown) {<br>    if (axiso.isCancel(thrown)) {<br>        console.log(‘Rquest canceled’, thrown.message);<br>    } else {<br>        // handle error<br>        // TODO<br>    }<br>});</p>
<p>// 取消请求(信息参数是可设置的)<br>source.cancel(‘Operation canceled by the user.’);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">可以给CancelToken构造函数传递一个executor function来创建一个cancel token：</span><br></pre></td></tr></table></figure></p>
<p>var CancelToken = axios.CancelToken;<br>var cancel;</p>
<p>axios.get(‘/user/12345’, {<br>    cancelToken: new CancelToken(function executor(c) {<br>        // 这个executor函数接受一个cancel function作为参数<br>        cancel = c;<br>    })<br>});</p>
<p>// 取消请求<br>cancel();<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### Node.js</span><br><span class="line"></span><br><span class="line">在nodejs中可以如下使用querystring：</span><br></pre></td></tr></table></figure></p>
<p>var querystring = require(‘querystring’);<br>axios.post(‘<a href="http://something.com/&#39;" target="_blank" rel="noopener">http://something.com/&#39;</a>, querystring.stringify({foo:’bar’}));<br><code>`</code></p>
<h3 id="Promises"><a href="#Promises" class="headerlink" title="Promises"></a>Promises</h3><p>axios基于原生的ES6 Promise实现。如果环境不支持请使用<a href="https://github.com/stefanpenner/es6-promise" target="_blank" rel="noopener">polyfill</a>。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/02/vue-router2基础＋实践/" itemprop="url">
                  vue-router2基础＋实践
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-03-02T00:00:00+08:00" content="2017-03-02">
              2017-03-02
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index">
                    <span itemprop="name">Vue</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/03/02/vue-router2基础＋实践/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/03/02/vue-router2基础＋实践/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Vue.js的一大特色就是构建单页面应用十分方便，vue-router是Vue.js官方的路由插件，它和vue.js是深度集成的，适合用于构建单页面应用。vue的单页面应用是基于路由和组件的，路由用于设定访问路径，并将路径和组件映射起来。传统的页面应用，是用一些超链接来实现页面切换和跳转的。在vue-router单页面应用中，则是路径之间的切换，也就是组件的切换。既然要方便构建单页面应用那么自然少不了路由，vue-router就是vue官方提供的一个路由框架。</p>
<h3 id="路由的安装"><a href="#路由的安装" class="headerlink" title="路由的安装"></a>路由的安装</h3><h4 id="npm安装"><a href="#npm安装" class="headerlink" title="npm安装"></a>npm安装</h4><p>可以使用npm直接安装插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router --save</span><br></pre></td></tr></table></figure>
<p>执行命令完成vue-router的安装，并在package.json中添加了vue-router的依赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">   ...</span><br><span class="line">   &quot;vue-router&quot;: &quot;^2.1.0&quot;</span><br><span class="line">   ...</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>如果是要安装在开发环境下，则使用以下命令行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router --save-dev</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">  ...</span><br><span class="line">  &quot;vue-router&quot;: &quot;^2.1.0&quot;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="直接下载-CDN"><a href="#直接下载-CDN" class="headerlink" title="直接下载/CDN"></a>直接下载/CDN</h4><p><a href="https://unpkg.com/vue-router/dist/vue-router.js" target="_blank" rel="noopener">https://unpkg.com/vue-router/dist/vue-router.js</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;/path/to/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;/path/to/vue-router.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="路由实现"><a href="#路由实现" class="headerlink" title="路由实现"></a>路由实现</h3><p>一个最简单的单页面应用</p>
<h4 id="app-js"><a href="#app-js" class="headerlink" title="app.js"></a>app.js</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import App from &apos;./App&apos;</span><br><span class="line">import VueRouter from &apos;vue-router&apos;</span><br><span class="line">import Page01 from &apos;./components/page01&apos;</span><br><span class="line">import Page02 from &apos;./components/page02&apos;</span><br><span class="line"></span><br><span class="line">Vue.use(VueRouter) // 全局安装路由功能</span><br><span class="line"></span><br><span class="line">// 定义路径</span><br><span class="line">const routes = [</span><br><span class="line">  &#123; path: &apos;/&apos;, component: Page01 &#125;,</span><br><span class="line">  &#123; path: &apos;/02&apos;, component: Page02 &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">// 创建路由对象</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">new Vue(&#123;</span><br><span class="line">  el: &apos;#app&apos;,</span><br><span class="line">  template: &apos;&lt;App/&gt;&apos;,</span><br><span class="line">  components: &#123; App &#125;,</span><br><span class="line">  router</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="App-vue"><a href="#App-vue" class="headerlink" title="App.vue"></a>App.vue</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;router-link to=&quot;/&quot;&gt;01&lt;/router-link&gt;</span><br><span class="line">    &lt;router-link to=&quot;/02&quot;&gt;02&lt;/router-link&gt;</span><br><span class="line">    &lt;br/&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<h4 id="page01-vue"><a href="#page01-vue" class="headerlink" title="page01.vue"></a>page01.vue</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;page01&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<h4 id="page02-vue"><a href="#page02-vue" class="headerlink" title="page02.vue"></a>page02.vue</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;page02&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>npm安装vue-router</li>
<li>Vue.use(VueRouter)全局安装路由功能</li>
<li>定义路径数组routes并创建路由对象router</li>
<li>将路由注入到Vue对象中</li>
<li>在根组件中使用<router-link>定义跳转路径</router-link></li>
<li>在根组件中使用<router-view>来渲染组件</router-view></li>
<li>创建子组件</li>
</ul>
<h3 id="路由的跳转"><a href="#路由的跳转" class="headerlink" title="路由的跳转"></a>路由的跳转</h3><h4 id="router-link"><a href="#router-link" class="headerlink" title="router-link"></a>router-link</h4><p><strong>router-link</strong>标签用于页面的跳转</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link to=&quot;/page01&quot;&gt;page01&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>
<p>点击router-link标签router-view就会渲染路径为/page01的页面。</p>
<h4 id="router-push"><a href="#router-push" class="headerlink" title="router.push"></a>router.push</h4><p>通过JS代码控制路由的界面渲染</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 字符串</span><br><span class="line">router.push(&apos;home&apos;)</span><br><span class="line">// 对象</span><br><span class="line">router.push(&#123; path: &apos;home&apos; &#125;)</span><br><span class="line">// 命名的路由</span><br><span class="line">router.push(&#123; name: &apos;user&apos;, params: &#123; userId: 123 &#125;&#125;)</span><br><span class="line">// 带查询参数，变成 /register?plan=private</span><br><span class="line">router.push(&#123; path: &apos;register&apos;, query: &#123; plan: &apos;private&apos; &#125;&#125;)</span><br></pre></td></tr></table></figure>
<p>实例中的语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 字符串</span><br><span class="line">this.$router.push(&apos;home&apos;)</span><br><span class="line">// 对象</span><br><span class="line">this.$router.push(&#123; path: &apos;home&apos; &#125;)</span><br><span class="line">// 命名的路由</span><br><span class="line">this.$router.push(&#123; name: &apos;user&apos;, params: &#123; userId: 123 &#125;&#125;)</span><br><span class="line">// 带查询参数，变成 /register?plan=private</span><br><span class="line">this.$router.push(&#123; path: &apos;register&apos;, query: &#123; plan: &apos;private&apos; &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="router-replace"><a href="#router-replace" class="headerlink" title="router.replace"></a>router.replace</h4><p>push方法会向 history 栈添加一个新的记录，而replace方法是替换当前的页面，不会向 history 栈添加一个新的记录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link to=&quot;/05&quot; replace&gt;05&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.$router.replace(&#123; path: &apos;/05&apos; &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="router-go"><a href="#router-go" class="headerlink" title="router.go"></a>router.go</h4><p>控制history记录的前进和后退</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 在浏览器记录中前进一步，等同于 history.forward()</span><br><span class="line">this.$router.go(1)</span><br><span class="line">// 后退一步记录，等同于 history.back()</span><br><span class="line">this.$router.go(-1)</span><br><span class="line">// 前进3步记录router.go(3)</span><br><span class="line">this.$router.go(3)</span><br></pre></td></tr></table></figure>
<h3 id="传参方式"><a href="#传参方式" class="headerlink" title="传参方式"></a>传参方式</h3><p>由跳转的过程中会传递一个object，我们可以通过watch方法查看路由信息对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  &apos;$route&apos; (to, from) &#123;</span><br><span class="line">      console.log(to);</span><br><span class="line">      console.log(from);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>控制台看到的路由信息对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  params: &#123; id: &apos;123&apos; &#125;,</span><br><span class="line">  query: &#123; name: &apos;jack&apos; &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="params"><a href="#params" class="headerlink" title="params"></a>params</h4><p>路由配置文件中定义参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  // 订单详情</span><br><span class="line">  path: &apos;/order/detail/:orderId&apos;,</span><br><span class="line">  name: &apos;orderDetail&apos;,</span><br><span class="line">  component: OrderDetailView</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>路径后面的/:orderId就是我们要传递的参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.$router.push(&#123; path: &apos;/order/detail/441&apos;&#125;);</span><br></pre></td></tr></table></figure>
<p>此时路由跳转的地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:3000/#/order/detail/441</span><br></pre></td></tr></table></figure>
<h5 id="组件中获取数据"><a href="#组件中获取数据" class="headerlink" title="组件中获取数据"></a>组件中获取数据</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2&gt;&#123;&#123; $route.params.orderId &#125;&#125;&lt;/h2&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.log(this.$route.params.orderId)</span><br></pre></td></tr></table></figure>
<h4 id="query"><a href="#query" class="headerlink" title="query"></a>query</h4><p>query传递数据的方式就是URL常见的查询参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link :to=&quot;&#123; path: &apos;/order/detail&apos;, query: &#123; id: item.id, stateId: item.stateId &#125;&#125;&quot;&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.$router.push(&#123;path: &apos;/order/detail&apos;, query: &#123;id: orderIdCache&#125;&#125;);</span><br></pre></td></tr></table></figure>
<p>获取数据和params是一样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2&gt;&#123;&#123; $route.query.orderId &#125;&#125;&lt;/h2&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.log(this.$route.query.orderId)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/10/微信小程序开发实践总结/" itemprop="url">
                  微信小程序开发实践总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-01-10T00:00:00+08:00" content="2017-01-10">
              2017-01-10
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/小程序/" itemprop="url" rel="index">
                    <span itemprop="name">小程序</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/01/10/微信小程序开发实践总结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/01/10/微信小程序开发实践总结/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>近日，小程序如约而至在1月9日凌晨在微信IOS和Android最新6.5.3版本中上线了期待已久的微信小程序，用户只需要更新最新版微信并搜索自己感兴趣的就能够体验已发布的小程序了。本人有幸和另一位团队的小伙伴也一起参与了公司车管家小程序的开发，我们前端这边的开发整体进度都还算顺利没有遇到特别坑的地方，当然这里离不开小伙伴雪娇童鞋她们在这之前做了很多产品和技术上的调研以及做了Demo的实践还有分享等等工作，都确保了我们开发上没有遇到大的阻碍。现将我从小程序的学习到开发到测试的过程中遇到的问题和踩的一些坑做一个小总结。</p>
<h3 id="关于整体的开发模式"><a href="#关于整体的开发模式" class="headerlink" title="关于整体的开发模式"></a>关于整体的开发模式</h3><p>小程序不像我们前端er日常开发web和H5那样在任意一个文本编辑器里编写代码在浏览器中就能实时看到页面还有本地和对外访问的链接地址，小程序是没有这些的（后面有牛人开发并开源了<strong>WEPT</strong>,集成了微信小程序组件UI可以在浏览器中查看调试）。微信为开发小程序应用提供了<strong>web开发者工具</strong>供开发者使用（实际开发中这工具开发体验真是low到可以了），建议大家实际开发时依旧使用自己的IDE，用<strong>WEPT</strong>或者<strong>web开发者工具</strong>查看页面。从小程序的开发语言中我们可以看到一些<code>React</code>、<code>Angular</code>以及<code>Vue</code>的影子，也许小程序就是集大成了这三大目前最主流的前端框架（?问号脸），因此只要开发者之前有这三种框架的开发经验再认真阅读阅读小程序的API文档，那么小程序的学习成本和上手开发成本都不是很高。它的模式很闭环很严格限制，只要按照最新的官方文档去规范开发，开发完成利用开发者工具平台打包压缩上传至微信服务器，然后微信进行审核，审核通过后会发布上线，用户在客户端搜索小程序名称获取并离线缓存至微信本地文件系统，供用户离线浏览访问。</p>
<h3 id="关于开发者工具"><a href="#关于开发者工具" class="headerlink" title="关于开发者工具"></a>关于开发者工具</h3><p><img src="http://oe3sqmqy4.bkt.clouddn.com/aa.png" alt></p>
<p>左侧边栏切换选项依次是：</p>
<h5 id="编辑"><a href="#编辑" class="headerlink" title="编辑"></a>编辑</h5><p>编辑选项中可以实时查看页面UI并且支持切换不同主流移动设备和网络环境以供适配和测试。右侧是代码编辑区，包括项目目录结构和文件编辑区。这里建议在新建目录或是文件时选择在开发者工具的这里新建比较快捷方便。编辑代码在自己的IDE中。</p>
<h5 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h5><p><img src="http://oe3sqmqy4.bkt.clouddn.com/b.png" alt></p>
<p>看着是不是眼熟？这不就是我们熟悉的Chrome的调试面板吗，是的没错，但需要注意我们看到的“Dom元素”是在<code>wxml</code>文件下的，这里看到的也不是标准的Dom，而是类似<code>React</code>微信封装的一系列自定义组件，比如<code>view</code>、<code>text</code>、<code>button</code>、<code>map</code>、<code>image</code>等。右边是<strong>Styles</strong>和<strong>Dataset</strong>，Styles查看组件样式内容的，Dataset是查看绑定在UI组件上的自定义<code>data-*</code>属性。这里注意调试页面时要将<strong>Wxml</strong>这个Tab选项排在面板第一位才能查看组件元素。</p>
<p><img src="http://oe3sqmqy4.bkt.clouddn.com/c.png" alt></p>
<p><strong>Sources面板</strong>可以查看项目资源文件，可以打断点调试页面对应js逻辑代码及<code>Watch</code>我们需要观察的变量等，这和<code>Chrome</code>里的差不多就不多赘述了。</p>
<p><img src="http://oe3sqmqy4.bkt.clouddn.com/d.png" alt></p>
<p><strong>AppData</strong>选项面板是web开发者工具特有的一项，提供的这个辅助功能非常有用，这里会显示每个页面<code>Page({})</code>实例中<code>data</code>数据对象的所有属性和值并且所有值都是可编辑的，这样就省去了不用我们开发调试时每次都要更改代码才能看到视图页面的变化，只要在这里编辑<code>data</code>属性的值就可以了，方便快捷高效。这里会显示你访问浏览过的页面对应的<code>Page({})</code>实例下的<code>data</code>数据对象，当然也可以只展示当前调试页面的<code>data</code>对象，将启动页面设置为当前调试页面即可。这里的<code>data</code>对象还支持<code>Code</code>和<code>Tree</code>两种切换查看模式，切换至<code>Code</code>模式下可以看到当前<code>data</code>对象下具体的所有数据。当声明的变量过多时这里还支持查询，可以快速锁定需要调试的变量属性。</p>
<h5 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h5><p><img src="http://oe3sqmqy4.bkt.clouddn.com/e.jpeg" alt></p>
<p>在项目面板中有以下几点小细节可以关注下：</p>
<ul>
<li>点击<strong>预览</strong>会生成一个二维码，开发者可以用手机设备扫二维码进行真机调试，如果在<code>app.json</code>中配置了<code>debug: true</code>，则如果在真机中打开调试就会出现<strong>vconsole</strong>控制台，可以进行一些log的输出及设备信息的查看。</li>
<li>如果只想单独调试某一个page，则可以点击<strong>预览</strong>右侧的小箭头进行自定义预览的页面设置。</li>
<li>下面有几个工具支持的功能，如果项目统一用ES6则可以勾选<strong>开启ES6转ES5</strong>；可以灵活的选择勾选<strong>监听文件变化自动刷新开发者工具</strong>，本人实际开发时是写页面的时候不勾选（因为每次习惯性的按<code>Ctrl+S</code>或<code>Commond+S</code>开发工具都会reload一遍，作为有轻微强迫症的我还是有点心疼自己mac的…我一般是手动刷新），当页面写完调试js逻辑功能时可以勾选。</li>
<li>最后一项<strong>开发环境不校验请求域名以及TLS版本</strong>，这是一个挺重要的功能，在开发时我们用的更多都是测试环境的接口，可能这些接口服务器域名不是<code>https</code>的或者不在事先管理后台配置的合法域名内，此时勾选这一项就可以正常使用测试环境的接口以及一些第三方平台提供的Mock数据接口，因为开发者工具帮你做了请求代理。</li>
<li>最下面的<strong>删除项目</strong>按钮可以将当前小程序项目从开发者工具中删除。</li>
</ul>
<h3 id="关于开发语言及小技巧"><a href="#关于开发语言及小技巧" class="headerlink" title="关于开发语言及小技巧"></a>关于开发语言及小技巧</h3><ul>
<li>wxml：基本上和写html是一样的，但一定要用小程序API提供的组件标记，不可随意使用HTML的一些标签元素！使用这些组件标记就会有默认的组件样式；可以像<code>Angular</code>和<code>Vue</code>一样在这些组件标记上绑定事件、条件判断指令、循环指令等。</li>
<li>wxss：小程序的页面样式表文件，官方推荐使用<strong>Flex</strong>弹性盒方式进行页面布局，以及提供了响应式单位<code>rpx</code>（设计图最好给成750的，开发时设计图是多少px对应样式属性就是多少rpx！），小程序提供了全局样式<code>app.wxss</code>和页面局部样式page的wxss文件，我们可以将项目的所有公共样式放在app.wxss中，这样可以复用到任何一个页面中。</li>
<li>特殊标记<code>block</code>：这不是一个UI组件，是一个包装元素，可以利用它很好的进行对页面结构进行判断循环展示等。</li>
<li>以<code>bind</code>和<code>catch</code>开头再加上事件名称就组成了小程序的绑定事件，还可以在标记元素上绑定自定义属性供逻辑层js获取。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;block wx:if=&quot;&#123;&#123;item.status === 1&#125;&#125;&quot;&gt;</span><br><span class="line">  &lt;button type=&quot;default&quot; hover-class=&quot;button-hover&quot; hover-stay-time=&quot;100&quot; class=&quot;btn-pay&quot; data-ordernum=&quot;&#123;&#123;item.ordernum&#125;&#125;&quot; bindtap=&quot;bindOrderPayTap&quot;&gt;立即支付&lt;/button&gt;</span><br><span class="line">&lt;/block&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bindOrderPayTap: function(e) &#123;</span><br><span class="line">  // 微信支付</span><br><span class="line">  Payment.requestPayment(&#123;</span><br><span class="line">    ordernum: e.target.dataset.ordernum ? e.target.dataset.ordernum : &apos;&apos;,</span><br><span class="line">    openId: App.globalData.openId ? App.globalData.openId : &apos;&apos;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>页面和路由跳转传参</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;navigator url=&quot;/pages/wz-records/wz-records?plateNum=京A12345&quot;&gt;&lt;/navigator&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wx.navigateTo(&#123;</span><br><span class="line">  url: &apos;../wz-records/wz-records?plateNum=&apos; + params.plateNum</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>目标页面接收参数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  onLoad(option) &#123;</span><br><span class="line">    wx.setNavigationBarTitle(&#123;</span><br><span class="line">      title: option.plateNum</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>在使用<code>wx:for</code>循环渲染时要添加<code>wx:key</code>否则会报<code>warning</code>警告。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;dj-group mb30&quot; wx:for=&quot;&#123;&#123;orderList&#125;&#125;&quot; wx:for-item=&quot;item&quot; wx:key=&quot;*this&quot;&gt;</span><br><span class="line">  &lt;!-- ... --&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>小程序虽然提供了ES6转化ES5，但是新的API比如说<code>Promise</code>它并不支持，那么恶心的异步回调地狱问题就不可避免了，我的做法是除过第一次的<code>request</code>外之后需要进行异步<code>request</code>的都单另封装在一个方法中，这样在请求的回调中调用方法即可不用层层<code>request</code>请求嵌套下去。</li>
<li>注意在<code>request</code>请求中，<code>method</code>不同对应的<code>header</code>的<code>content-type</code>也是不同的（这点很重要！）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">wx.request(&#123;</span><br><span class="line">  url: &apos;&apos;,</span><br><span class="line">  method: &apos;GET&apos;,</span><br><span class="line">  header: &#123;</span><br><span class="line">    &apos;content-type&apos;: &apos;application/json&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  success: (res) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  fail: (res) =&gt; &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>当<code>method</code>为<code>GET</code>方式时：<code>&#39;content-type&#39;: &#39;application/json&#39;</code></p>
<p>当<code>method</code>为<code>POST</code>方式（或者表单提交）时：<code>&#39;content-type&#39;: &#39;application/x-www-form-urlencoded&#39;</code></p>
<ul>
<li><p>注意event.target.dataset与event.currentTarget.dataset的区别：target.dataset是取源组件上设置的数据集合，currentTarget.dataset是取当前组件上设置的数据集合。</p>
</li>
<li><p>微信官方给出的page的生命周期的图片:</p>
</li>
</ul>
<p><img src="http://img.blog.csdn.net/20161012190123468" alt></p>
<h3 id="关于开发建议"><a href="#关于开发建议" class="headerlink" title="关于开发建议"></a>关于开发建议</h3><ul>
<li>在项目中我们可以将公共的工具方法、公共的配置项（如接口URL等）、公用的业务逻辑（如调起微信支付等）抽离当前业务成公共方法，这样满足模块化开发的思想也提高了代码的高度复用性。</li>
<li>如果团队统一使用ES6语法开发切记一定要在开发者工具、IOS手机设备、Android手机设备上运行都是不报错没有问题的！！我在一处使用了<code>for (let item of arr) {}</code>语法循环数据时就踩坑了，一直以为没问题直到最后提测时才发现在安卓上这ES6语法报错不识别，最后改成了<code>.forEach(function(item, index) {})</code>。</li>
<li>写页面布局结构时最好使用Flex弹性盒布局。</li>
<li>使用navigateTo路由跳转时，小程序会缓存上一个页面到内存栈中（最多5个！）所以一些加载页面时做的一些逻辑判断一定写在<code>onLoad</code>或者<code>onReady</code> <code>onShow</code>中。</li>
<li>所有图片资源都先在本地压缩（小图标图做sprit合并）然后再统一上传到CDN服务器上，页面图片地址直接走https服务器（因为小程序最大限制1M所以最好别把图片放本地了）。</li>
<li>微信登陆通过<code>code</code>获取<code>openId</code>作为小程序用户的唯一标识，小程序提供了微信用户登录的接口API以及获取用户信息的API，不过并不会反回用户的<code>openId</code>，此时需要我们自己的服务端提供这样的接口来获取用户的<code>openId</code>。具体实现方法是先调用登陆请求方法<code>wx.login({})</code>后返回<code>code</code>，再通过<code>code</code>去请求我们自己服务器的接口用来返回<code>openId</code>。具体代码实现如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// 用户登录</span><br><span class="line">wx.login(&#123;</span><br><span class="line"> success: (res) =&gt; &#123;</span><br><span class="line">   // 获取openId</span><br><span class="line">   if (res.code) &#123;</span><br><span class="line">     wx.request(&#123;</span><br><span class="line">       url: &apos;&apos;,</span><br><span class="line">       method: &apos;POST&apos;,</span><br><span class="line">       data: &#123;</span><br><span class="line">         code: res.code</span><br><span class="line">       &#125;,</span><br><span class="line">       header: &#123;</span><br><span class="line">         &apos;content-type&apos;: &apos;application/x-www-form-urlencoded&apos;</span><br><span class="line">       &#125;,</span><br><span class="line">       success: (res) =&gt; &#123;</span><br><span class="line">         if (res.data &amp;&amp; res.data.errcode === 0) &#123;</span><br><span class="line">           if (res.data.openid) &#123;</span><br><span class="line">             that.globalData.openId = res.data.openid;</span><br><span class="line">           &#125;</span><br><span class="line">         &#125; else &#123;</span><br><span class="line">           console.log(&apos;获取openId失败：&apos; + res.data.errcode + &apos;=====&gt;&apos; + res.data.errmsg)</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>成功获取到<code>openId</code>后我们可以将其绑定在全局变量<code>globalData</code>上，这样就可以在任意<code>page</code>中访问到<code>globeData</code>下的<code>openId</code>。</p>
<ul>
<li>微信支付：小程序提供了调用微信支付的API方法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">wx.requestPayment(&#123;</span><br><span class="line">  &apos;timeStamp&apos;: &apos;&apos;,</span><br><span class="line">  &apos;nonceStr&apos;: &apos;&apos;,</span><br><span class="line">  &apos;package&apos;: &apos;&apos;,</span><br><span class="line">  &apos;signType&apos;: &apos;MD5&apos;,</span><br><span class="line">  &apos;paySign&apos;: &apos;&apos;,</span><br><span class="line">  &apos;success&apos;:function(res)&#123;</span><br><span class="line">  	</span><br><span class="line">  &#125;,</span><br><span class="line">  &apos;fail&apos;:function(res)&#123;</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>一开始看文档以为需要传的这5个参数值是前端要做的，后面仔细看了关于支付方面的文档和技术原理示意图，发现这几个参数不需要前端处理（也不安全…），这依旧需要我们自己的服务端提供接口给返回，最后沟通了公司负责支付相关的部门他们给予了支持，所有所需参数都由负责支付部门的提供返回。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">let requestPayment = (obj) =&gt; &#123;</span><br><span class="line">  return wx.request(&#123;</span><br><span class="line">    url: &apos;&apos;, // 开发者自己业务的服务端接口</span><br><span class="line">    method: &apos;GET&apos;,</span><br><span class="line">    data: &#123;</span><br><span class="line">      ordernum: obj.ordernum,</span><br><span class="line">      openid: obj.openId</span><br><span class="line">    &#125;,</span><br><span class="line">    header: &#123;</span><br><span class="line">      &apos;content-type&apos;: &apos;application/json&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    success: (res) =&gt; &#123;</span><br><span class="line">      if (res.data &amp;&amp; res.data.returncode === 1) &#123;</span><br><span class="line">        const result = res.data.result ? res.data.result : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        // 微信支付</span><br><span class="line">        wx.requestPayment(&#123;</span><br><span class="line">          &apos;timeStamp&apos;: result.timeStamp, // 当前时间戳</span><br><span class="line">          &apos;nonceStr&apos;: result.nonceStr, // 随机字符串</span><br><span class="line">          &apos;package&apos;: result.package, // 统一下单接口</span><br><span class="line">          &apos;signType&apos;: result.signType, // 签名算法</span><br><span class="line">          &apos;paySign&apos;: result.paySign, // 签名</span><br><span class="line">          &apos;success&apos;: (res) =&gt; &#123;</span><br><span class="line">            if (res.errMsg === &apos;requestPayment:ok&apos;) &#123;</span><br><span class="line">              // 成功</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">              // TODO</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &apos;fail&apos;: (res) =&gt; &#123;</span><br><span class="line">            // 用户取消支付</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        // TODO</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    fail: (res) =&gt; &#123;</span><br><span class="line">      // TODO</span><br><span class="line">    &#125;,</span><br><span class="line">    complete: (res) =&gt; &#123;</span><br><span class="line">      // TODO</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="思考与总结"><a href="#思考与总结" class="headerlink" title="思考与总结"></a>思考与总结</h3><h4 id="优势？"><a href="#优势？" class="headerlink" title="优势？"></a>优势？</h4><ul>
<li><p>低门槛下载，作为微信的一环，可以通过微信直接进入，即可使用。</p>
</li>
<li><p>跨平台，微信客户端底层封装，支持小程序跨平台。</p>
</li>
<li><p>开发成本低，通过之前的开发对比，小程序的开发比web app 的开发成本还低，并且前端的资源存放、发布运维都集成在微信中。</p>
</li>
<li><p>页面仿原生，体验更流畅。</p>
</li>
<li><p>小程序可以使用微信的支付功能。</p>
</li>
</ul>
<h4 id="局限？"><a href="#局限？" class="headerlink" title="局限？"></a>局限？</h4><ul>
<li><p>开发基于微信框架，部分功能受限，不支持现有的其他第三方插件。</p>
</li>
<li><p>小程序页面只能同时打开5个，如果交互流程较长难以支持。</p>
</li>
<li><p>小程序包大小限制为1M（目前），所有只适合轻量级。</p>
</li>
</ul>
<p>最后安利一段最近看到的不错的语录：</p>
<blockquote>
<p>“所有的成长过程都是从提出一个问题开始，并找到了答案，最后融入自身的价值观，完成下一次更好的选择，周而复始。”</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/10/使用Service workers实现离线内容/" itemprop="url">
                  使用Service workers实现离线内容
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-10T00:00:00+08:00" content="2016-11-10">
              2016-11-10
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/PWA/" itemprop="url" rel="index">
                    <span itemprop="name">PWA</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/10/使用Service workers实现离线内容/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/10/使用Service workers实现离线内容/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>原文地址：<a href="https://madebymike.com.au//writing/service-workers/" target="_blank" rel="noopener">Offline content with service workers</a></p>
</blockquote>
<p>Service workers不只是对网页进行离线支持它还可以做很多事情，但是包括我自己在内对于大多数人而言，这将是他们的第一次使用Service workers经验。我最近给我的博客实现了一个简单的离线页面，令我惊喜的是使用它竟然是如此的简单。（充满着十足的自信）我想我可以做更多的事情。我决定开始保存我的博客文章从而实现离线阅读，并且很快开始投入实践。之后我很快意识到这个“坑”很深。</p>
<p>这并不是在责怪service workers，而这是一个迹象，说明它们是多么的强大和灵活。还好发现的及时，随着概念变得越来越熟悉，以及复杂性逐渐被抽象化，离线内容将变得更加常见。事实上，我喝了Kool-Aid(译者注：一种饮料)，并且我可以知道为什么很多人认为，在几年内离线内容将像如今在web开发中的响应式设计一样变的无处不在。</p>
<p>话虽如此，但是在开始之前这里有一些事情我希望我是知道的。</p>
<h3 id="浏览器支持缓存"><a href="#浏览器支持缓存" class="headerlink" title="浏览器支持缓存"></a>浏览器支持缓存</h3><p>Service workers表面上看是一个渐进增强的简单备选方案，在注册一个service worker之前检测它的支持性是很简单的。你可以像这样去做：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (&apos;serviceWorker&apos; in navigator) &#123;</span><br><span class="line">  // Yay, service workers work!</span><br><span class="line">  navigator.serviceWorker.register(&apos;/sw.js&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看上去似乎足够简单，但是这里有一个问题。如果你看过了<a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache" target="_blank" rel="noopener">MDN page for the service worker cache API</a>，你将会了解到不同版本的Chrome浏览器支持不同的缓存方法。这也就意味着，尽管你认真努力的做了功能的支持性检测，当使用<code>addAll</code>方法的时候介于版本为40和45之间的Chrome将会出现一个错误。当这些版本的浏览器被更加广泛的使用的时候这就是一个问题了。我在写这篇文章的时候已经在<a href="http://caniuse.com/usage-table" target="_blank" rel="noopener">Can I Use</a>检测过了，看上去它可能会影响到约1.15%的用户。</p>
<p>在开始service workers之前我已经读了几篇相关的博客和教程。一些人主张仅仅是使用<code>put</code>而不是<code>addAll</code>，其他人则推荐使用<a href="https://github.com/dominiccooney/cache-polyfill" target="_blank" rel="noopener">cache pollyfill</a>，尽管其他一些人还仍然没有提到它。明显的这些都是在不同的时间段写的，并且为了找出正确的方式我花费了很多的时间去研究它。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/11/10/使用Service workers实现离线内容/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/31/构建跨平台Electron应用4个必知的小技巧/" itemprop="url">
                  构建跨平台Electron应用4个必知的小技巧
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-31T00:00:00+08:00" content="2016-10-31">
              2016-10-31
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index">
                    <span itemprop="name">Electron</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/31/构建跨平台Electron应用4个必知的小技巧/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/31/构建跨平台Electron应用4个必知的小技巧/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>原文地址：<a href="https://blog.avocode.com/blog/4-must-know-tips-for-building-cross-platform-electron-apps" target="_blank" rel="noopener">4 must-know tips for building cross platform Electron apps</a></p>
</blockquote>
<p><img src="http://oe3sqmqy4.bkt.clouddn.com/22dc7f3e89b76e7b581c.png" alt></p>
<p>在其他众多的应用中，<a href="https://electron.atom.io/" target="_blank" rel="noopener">Electron</a>技术驱动着Avocode（译者注：一款设计师和开发者的合作工具），Electron可以让你构建一个运行非常快速流畅的跨平台桌面应用。</p>
<blockquote>
<p>If you don’t pay attention you will quickly end up in the uncanny valley of apps, though. Apps that don’t feel quite in place among your other apps.（如果有些问题不注意的话，你的App很快就会掉到“坑”里，无法从其它众多App中脱颖而出。）</p>
</blockquote>
<p>这是2016年5月在阿姆斯特丹的<strong>Electron Meetup</strong>上我做的发言的整理稿内容，由于要考虑到API的变化所以这里做了一些更新。值得注意的是，我这里会做一些更加详细的叙述，并且假设你们对Electron有了一些了解。</p>
<h4 id="首先，我是谁？"><a href="#首先，我是谁？" class="headerlink" title="首先，我是谁？"></a>首先，我是谁？</h4><p>我是Kilian Valkhof，一个前端开发者、交互设计师、app开发者，当然这取决于你问的对象是谁了。我有超过10年的互联网从业经验，并且在各式各样的环境下开发出很多的桌面应用，比如<strong>GTK</strong>和<strong>Qt</strong>，当然了它们都是使用的Electron。</p>
<p>我最近开发的应用是<a href="https://fromscratch.rocks/" target="_blank" rel="noopener">Fromscratch</a>，它是一款跨平台免费的带有自动保存功能的记笔记应用。</p>
<p>在开发Fromscratch期间，我花了大量时间去确保这款应用在所有三大平台上都能保持良好的运行且可以感觉到体验很棒，并找出了可以用Electron来实现它的方法。这些都是我挖坑填坑过程中积累起来的。</p>
<p>让一款使用Electron开发的应用体验起来很好并且很稳定并不难，而你仅仅需要去确定你关注到的是它的细节。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/10/31/构建跨平台Electron应用4个必知的小技巧/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/27/优惠券活动模版功能开发之填坑小结/" itemprop="url">
                  优惠券活动模版功能开发之填坑小结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-27T00:00:00+08:00" content="2016-09-27">
              2016-09-27
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/27/优惠券活动模版功能开发之填坑小结/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/27/优惠券活动模版功能开发之填坑小结/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="踩坑背景简述"><a href="#踩坑背景简述" class="headerlink" title="踩坑背景简述"></a>踩坑背景简述</h3><p>最近负责养车M端优惠券活动模版功能的开发，由于这次开发任务本来不是安排给我的，所以这个功能产品在做需求评审宣讲时我没有参加，固很多逻辑和交互细节都不是很清楚，当然也包括M端一些不能解的坑在宣讲时也没有向产品讲清楚，到我这就只能接受得按照原型去实现…迎难而上，开整！</p>
<h3 id="一-fixed定位和输入框弹出键盘问题"><a href="#一-fixed定位和输入框弹出键盘问题" class="headerlink" title="一.fixed定位和输入框弹出键盘问题"></a>一.fixed定位和输入框弹出键盘问题</h3><h4 id="遇到的坑"><a href="#遇到的坑" class="headerlink" title="遇到的坑"></a>遇到的坑</h4><p>看了原型设计就发现了一个不好解的坑：需求是要把带文本框的登录窗浮层固定在浏览器可视区最底部。</p>
<p>大概就是这个样子（红色区域）：</p>
<p><img src="http://oe3sqmqy4.bkt.clouddn.com/WechatIMG442.jpeg" alt></p>
<p>大家想必一看也知道怎么回事了，要实现底部固定定位显示就得用<code>position: fixed;</code>，但是有输入框就会有软键盘弹出，<strong><em>fixed</em></strong>加上弹出键盘产生的各种兼容性问题各种奇奇怪怪的现象各种闪屏卡屏问题，像这种常识性的前端坑应该在需求评审时就打回去或者M端存在的问题和风险应该向产品和项目讲清楚的，好像并没有…</p>
<h4 id="实践折中解决办法"><a href="#实践折中解决办法" class="headerlink" title="实践折中解决办法"></a>实践折中解决办法</h4><p>经过和产品耐心的一遍又一遍的讲解这个坑的问题（包括走邮件这种很正式的流程…）后，产品才答应将登录窗底部浮层固定显示改为点击按钮模态弹窗形式显示。有输入框弹出键盘那<strong><em>fixed</em></strong>肯定不能用啊，那只有弹窗<code>position: absolute;</code>了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.modal-dialog &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 38%;</span><br><span class="line">  left: 50%;</span><br><span class="line">  -webkit-transform: translate3d(-50%, -50%, 0);</span><br><span class="line">  transform: translate3d(-50%, -50%, 0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那么这样的话为了不让浮层跟随页面滑动，<code>body</code>和<code>html</code>就得动态添加<code>class</code>。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/09/27/优惠券活动模版功能开发之填坑小结/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/02/给所有的Web应用程序添加离线支持/" itemprop="url">
                  给所有的Web应用程序添加离线支持
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-02T00:00:00+08:00" content="2016-09-02">
              2016-09-02
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Web-App/" itemprop="url" rel="index">
                    <span itemprop="name">Web App</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/02/给所有的Web应用程序添加离线支持/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/02/给所有的Web应用程序添加离线支持/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>原文地址：<a href="https://medium.com/google-developer-experts/add-offline-support-to-any-web-app-c20edc4bea0e#.wn48rpi75" target="_blank" rel="noopener">Add offline support to any Web app</a></p>
</blockquote>
<p>最近，我参加了<a href="https://www.angularattack.com/" target="_blank" rel="noopener">Angular Attack 2016 Hackathon</a>编程马拉松活动，并且开发出了一款叫做“<a href="https://www.angularattack.com/entries/101-angularlabs-london" target="_blank" rel="noopener">Let Me See</a>”的应用，它可以帮助那些失明的人们看到世界（PS：瞬间感觉很伟大的样子…）。这款应用通过使用<a href="http://blog.ionic.io/built-with-ionic-2-let-me-see/" target="_blank" rel="noopener">Ionic2</a>（当然也有<a href="https://angular.io/" target="_blank" rel="noopener">Angular2</a>）开发而成。最重要的是我想要让这款应用是更加进步更加优秀的，所以为了得到一个更好的及时加载体验，我给它添加了支持离线缓存的功能。那么下面就让我告诉你们我是如何简单又快速地添加这项功能的。</p>
<blockquote>
<p>Oh! By the way, “Let Me See” has won the Innovation prize!（哦!对了，“Let Me See”已经荣获了创新奖！）</p>
</blockquote>
<p>在我们开始之前，我要假设你们已经有了一个现有的Web app应用了（PS：哈哈，够强势）。接下来我将用“Let Me See”作为例子一起来进行以下的步骤操作，并且这些步骤将适用于任何现代的单页面应用。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/09/02/给所有的Web应用程序添加离线支持/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/26/使用命令行api更轻易得调试web应用/" itemprop="url">
                  使用命令行API更轻易得调试Web应用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-26T00:00:00+08:00" content="2016-07-26">
              2016-07-26
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Dev-Tool/" itemprop="url" rel="index">
                    <span itemprop="name">Dev Tool</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/26/使用命令行api更轻易得调试web应用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/26/使用命令行api更轻易得调试web应用/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>原文链接：<a href="http://developer.telerik.com/content-types/tutorials/easier-web-application-debugging-command-line-api/" target="_blank" rel="noopener">http://developer.telerik.com/content-types/tutorials/easier-web-application-debugging-command-line-api/</a></p>
</blockquote>
<p><img src="http://developer.telerik.com/wp-content/uploads/2016/05/command_line_api_header.jpg" alt="图片 文章参考截图"></p>
<p>很多年以前，调试一段JavaScript代码几乎全部依赖于<code>console.log()</code>来调用正在研究中的一个或多个函数。有时你已经意识到，问题不是在这些功能而是在一个由他们调用的函数中，从而更加使得<code>console.log()</code>的调用将被添加到代码中。这通常也会伴随着相当多的脏话（吐槽？抱怨？）。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/07/26/使用命令行api更轻易得调试web应用/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/04/28/jQuery基础/" itemprop="url">
                  jQuery基础
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-04-28T00:00:00+08:00" content="2015-04-28">
              2015-04-28
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/jQuery/" itemprop="url" rel="index">
                    <span itemprop="name">jQuery</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/04/28/jQuery基础/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/04/28/jQuery基础/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.有两个版本的 jQuery 可供下载：<br>Production version - 用于实际的网站中，已被精简和压缩。<br>Development version - 用于测试和开发（未压缩，是可读的代码）</p>
<p>2.$(this).hide() - 隐藏当前元素</p>
<p>3.隐藏/显示：<br>$(selector).hide(speed,callback);</p>
<p>$(selector).show(speed,callback);<br>可选的 speed 参数规定隐藏/显示的速度，可以取以下值：”slow”、”fast” 或毫秒。<br>可选的 callback 参数是隐藏或显示完成后所执行的函数名称。</p>
<p>4.切换显示和隐藏：<br>$(selector).toggle(speed,callback);</p>
<p>5.淡入/淡出<br>$(selector).fadeIn(speed,callback);<br>$(selector).fadeOut(speed,callback);<br>$(selector).fadeToggle(speed,callback);<br>$(selector).fadeTo(speed,opacity,callback);</p>
<p>6.上下滑动：<br>$(selector).slideDown(speed,callback);<br>$(selector).slideUp(speed,callback);<br>$(selector).slideToggle(speed,callback);</p>
<p>7.动画<br>$(selector).animate({params},speed,callback);<br>必需的 params 参数定义形成动画的 CSS 属性。<br>可选的 speed 参数规定效果的时长。它可以取以下值：”slow”、”fast” 或毫秒。<br>可选的 callback 参数是动画完成后所执行的函数名称。<br>默认地，所有 HTML 元素都有一个静态位置，且无法移动。如需对位置进行操作，要记得首先把元素的 CSS position 属性设置为 relative、fixed 或 absolute！</p>
<p>8.停止动画<br>$(selector).stop(stopAll,goToEnd); //(false,false) —&gt; (true,true)</p>
<p>Callback 、Chaining …</p>
<p>9.获得内容 - text()、html() 以及 val()<br>三个简单实用的用于 DOM 操作的 jQuery 方法：<br>text() - 设置或返回所选元素的文本内容<br>html() - 设置或返回所选元素的内容（包括 HTML 标记）<br>val() - 设置或返回表单字段的值</p>
<p>attr() 方法用于获取属性值。</p>
<p>10.添加新的 HTML 内容<br>我们将学习用于添加新内容的四个 jQuery 方法：<br>append() - 在被选元素的结尾插入内容<br>prepend() - 在被选元素的开头插入内容<br>after() - 在被选元素之后插入内容<br>before() - 在被选元素之前插入内容</p>
<p>11.删除<br>jQuery remove() 方法删除被选元素及其子元素。<br>jQuery empty() 方法删除被选元素的子元素。</p>
<p>12.jQuery 操作 CSS<br>jQuery 拥有若干进行 CSS 操作的方法。我们将学习下面这些：<br>addClass() - 向被选元素添加一个或多个类<br>removeClass() - 从被选元素删除一个或多个类<br>toggleClass() - 对被选元素进行添加/删除类的切换操作<br>css() - 设置或返回样式属性</p>
<p>13.jQuery 尺寸 方法<br>jQuery 提供多个处理尺寸的重要方法：<br>width()  //.width(200) 设置值<br>height()<br>innerWidth()<br>innerHeight()<br>outerWidth()   //true:包括内边距、边框和外边距<br>outerHeight()   //true:包括内边距、边框和外边距</p>
<p>14.向上遍历 DOM 树<br>这些 jQuery 方法很有用，它们用于向上遍历 DOM 树：<br>parent() 直接<br>parents() 所有<br>parentsUntil() 之间</p>
<p>15.向下遍历 DOM 树<br>下面是两个用于向下遍历 DOM 树的 jQuery 方法：<br>children() 直接<br>find() 所有后代 find(‘*’)</p>
<p>16.在 DOM 树中水平遍历<br>有许多有用的方法让我们在 DOM 树进行水平遍历：<br>siblings() 方法返回被选元素的所有同胞元素。<br>next() 方法返回被选元素的下一个同胞元素。<br>nextAll() 方法返回被选元素的所有跟随的同胞元素。<br>nextUntil() 方法返回介于两个给定参数之间的所有跟随的同胞元素<br>prev()<br>prevAll()<br>prevUntil()</p>
<p>17.过滤<br>first() 方法返回被选元素的首个元素。<br>last() 方法返回被选元素的最后一个元素。<br>eq() 方法返回被选元素中带有指定索引号的元素。// 0 1 2 …<br>filter() 方法允许您规定一个标准。不匹配这个标准的元素会被从集合中删除，匹配的元素会被返回。<br>not() 方法返回不匹配标准的所有元素。提示：not() 方法与 filter() 相反。</p>
<ol start="18">
<li>load() 方法完成后所要允许的回调函数。回调函数可以设置不同的参数：<br>responseTxt - 包含调用成功时的结果内容<br>statusTXT - 包含调用的状态<br>xhr - 包含 XMLHttpRequest 对象</li>
</ol>
<p>19.<br>$.get(URL,callback);<br>$.get() 的第一个参数是我们希望请求的 URL（”demo_test.asp”）。第二个参数是回调函数。第一个回调参数存有被请求页面的内容，第二个回调参数存有请求的状态。</p>
<p>$.post(URL,data,callback);<br>$.post() 的第一个参数是我们希望请求的 URL (“demo_test_post.asp”)。然后我们连同请求（name 和 city）一起发送数据。”demo_test_post.asp” 中的 ASP 脚本读取这些参数，对它们进行处理，然后返回结果。第三个参数是回调函数。第一个回调参数存有被请求页面的内容，而第二个参数存有请求的状态。</p>
<p>20.jQuery noConflict() 方法<br>如果你的 jQuery 代码块使用 $ 简写，并且您不愿意改变这个快捷方式，那么您可以把 $ 符号作为变量传递给 ready 方法。这样就可以在函数内使用 $ 符号了 - 而在函数外，依旧不得不使用 “jQuery”：<br>$.noConflict();<br>jQuery(document).ready(function($){<br>  $(“button”).click(function(){<br>    $(“p”).text(“jQuery 仍在运行！”);<br>  });<br>});</p>
<p>21.<br>  GET POST<br>后退按钮/刷新 无害 数据会被重新提交（浏览器应该告知用户数据会被重新提交）。<br>书签 可收藏为书签 不可收藏为书签<br>缓存 能被缓存 不能缓存<br>编码类型 application/x-www-form-urlencoded application/x-www-form-urlencoded 或 multipart/form-data。为二进制数据使用多重编码。<br>历史 参数保留在浏览器历史中。 参数不会保存在浏览器历史中。<br>对数据长度的限制 是的。当发送数据时，GET 方法向 URL 添加数据；URL 的长度是受限制的（URL 的最大长度是 2048 个字符）。 无限制。<br>对数据类型的限制 只允许 ASCII 字符。 没有限制。也允许二进制数据。<br>安全性 与 POST 相比，GET 的安全性较差，因为所发送的数据是 URL 的一部分。在发送密码或其他敏感信息时绝不要使用 GET ！ POST 比 GET 更安全，因为参数不会被保存在浏览器历史或 web 服务器日志中。<br>可见性 数据在 URL 中对所有人都是可见的。 数据不会显示在 URL 中。</p>
<p>方法 描述<br>HEAD 与 GET 相同，但只返回 HTTP 报头，不返回文档主体。<br>PUT 上传指定的 URI 表示。<br>DELETE 删除指定资源。<br>OPTIONS 返回服务器支持的 HTTP 方法。<br>CONNECT 把请求连接转换到透明的 TCP/IP 通道。</p>
<p>append()前面是要选择的对象，后面是要在对象内插入的元素内容<br>appendTo()前面是要插入的元素内容，而后面是要选择的对象</p>
<hr>
<p>选择器 描述<br>.after( content ) 在匹配元素集合中的每个元素后面插入参数所指定的内容，作为其兄弟节点<br>.before( content ) 据参数设定，在匹配元素的前面插入内容<br>after向元素的后边添加html代码，如果元素后面有元素了，那将后面的元素后移，然后将html代码插入</p>
<h2 id="before向元素的前边添加html代码，如果元素前面有元素了，那将前面的元素前移，然后将html代码插"><a href="#before向元素的前边添加html代码，如果元素前面有元素了，那将前面的元素前移，然后将html代码插" class="headerlink" title="before向元素的前边添加html代码，如果元素前面有元素了，那将前面的元素前移，然后将html代码插"></a>before向元素的前边添加html代码，如果元素前面有元素了，那将前面的元素前移，然后将html代码插</h2><p>选择器 描述<br>prepend 向每个匹配的元素内部前置内容<br>prependTo 把所有匹配的元素前置到另一个指定的元素集合中<br>append()向每个匹配的元素内部追加内容<br>prepend()向每个匹配的元素内部前置内容<br>appendTo()把所有匹配的元素追加到另一个指定元素的集合中</p>
<h2 id="prependTo-把所有匹配的元素前置到另一个指定的元素集合中"><a href="#prependTo-把所有匹配的元素前置到另一个指定的元素集合中" class="headerlink" title="prependTo()把所有匹配的元素前置到另一个指定的元素集合中"></a>prependTo()把所有匹配的元素前置到另一个指定的元素集合中</h2><p>选择器 描述<br>insertBefore 在目标元素前面插入集合中每个匹配的元素<br>insertAfter 在目标元素后面插入集合中每个匹配的元素<br>.before()和.insertBefore()实现同样的功能。主要的区别是语法——内容和目标的位置。 对于before()选择表达式在函数前面，内容作为参数，而.insertBefore()刚好相反，内容在方法前面，它将被放在参数里元素的前面<br>.after()和.insertAfter() 实现同样的功能。主要的不同是语法——特别是（插入）内容和目标的位置。 对于after()选择表达式在函数的前面，参数是将要插入的内容。对于 .insertAfter(), 刚好相反，内容在方法前面，它将被放在参数里元素的后面</p>
<h2 id="before、after与insertBefore。insertAfter的除了目标与位置的不同外，后面的不支持多参数处理"><a href="#before、after与insertBefore。insertAfter的除了目标与位置的不同外，后面的不支持多参数处理" class="headerlink" title="before、after与insertBefore。insertAfter的除了目标与位置的不同外，后面的不支持多参数处理"></a>before、after与insertBefore。insertAfter的除了目标与位置的不同外，后面的不支持多参数处理</h2><p>方法名 参数 事件及数据是否也被移除 元素自身是否被移除<br>remove 支持选择器表达 是 是（无参数时），有参数时要根据参数所涉及的范围</p>
<h2 id="detach-参数同remove-否-情况同remove"><a href="#detach-参数同remove-否-情况同remove" class="headerlink" title="detach 参数同remove 否 情况同remove"></a>detach 参数同remove 否 情况同remove</h2><h2 id="“html”-parent-方法返回一个包含document的集合，而-“html”-parents-返回一个空集合。"><a href="#“html”-parent-方法返回一个包含document的集合，而-“html”-parents-返回一个空集合。" class="headerlink" title="$( “html” ).parent()方法返回一个包含document的集合，而$( “html” ).parents()返回一个空集合。"></a>$( “html” ).parent()方法返回一个包含document的集合，而$( “html” ).parents()返回一个空集合。</h2><p>parents()和.closest()：<br>起始位置不同：.closest开始于当前元素 .parents开始于父元素<br>遍历的目标不同：.closest要找到指定的目标，.parents遍历到文档根元素，closest向上查找，知道找到一个匹配就停止查找，parents一直查找到根元素，并将匹配的元素加入集合</p>
<h2 id="结果不同：-closest返回的是包含零个或一个元素的jquery对象，parents返回的是包含零个或一个或多个元素的jquery对象"><a href="#结果不同：-closest返回的是包含零个或一个元素的jquery对象，parents返回的是包含零个或一个或多个元素的jquery对象" class="headerlink" title="结果不同：.closest返回的是包含零个或一个元素的jquery对象，parents返回的是包含零个或一个或多个元素的jquery对象"></a>结果不同：.closest返回的是包含零个或一个元素的jquery对象，parents返回的是包含零个或一个或多个元素的jquery对象</h2><p>each是一个for循环的包装迭代器<br>each通过回调的方式处理，并且会有2个固定的实参，索引与元素<br>each回调方法中的this指向当前迭代的dom元素</p>
<hr>
<p>几种方式可以隐藏一个元素：<br>CSS display的值是none。<br>type=”hidden”的表单元素。<br>宽度和高度都显式设置为0。<br>一个祖先元素是隐藏的，该元素是不会在页面上显示<br>CSS visibility的值是hidden</p>
<h2 id="CSS-opacity的指是0"><a href="#CSS-opacity的指是0" class="headerlink" title="CSS opacity的指是0"></a>CSS opacity的指是0</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/09/11/Oracle 行转列SQL后台代码/" itemprop="url">
                  Oracle 行转列SQL后台代码
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-09-11T00:00:00+08:00" content="2014-09-11">
              2014-09-11
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2014/09/11/Oracle 行转列SQL后台代码/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/09/11/Oracle 行转列SQL后台代码/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">String mapSql = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">for(String key : map.keySet()) &#123;</span><br><span class="line">  Map&lt;String, String&gt; tempMap = map.get(key);</span><br><span class="line"></span><br><span class="line">  for(String tempKey : tempMap.keySet()) &#123;</span><br><span class="line">    colName = tempMap.get(tempKey);</span><br><span class="line">    colCode = tempKey;</span><br><span class="line">    if(!&quot;&quot;.equals(mapSql))&#123;</span><br><span class="line">     mapSql += &quot; UNION ALL &quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    StringBuffer sqs = new StringBuffer();</span><br><span class="line">    sqs.append(&quot;SELECT &apos;&quot;+colCode+&quot;&apos;, T.* FROM (WITH pivot_data AS (SELECT &apos;&quot;+ colName +&quot;&apos;,&quot;+ colCode +&quot;, TAB_YEAR &quot;);</span><br><span class="line">    sqs.append(&quot;FROM US_APP.&quot;+key+&quot;)  SELECT *  FROM   pivot_data  PIVOT (SUM(&quot;+ colCode +&quot;)&quot;);</span><br><span class="line">    sqs.append(&quot;FOR TAB_YEAR IN  (&quot;+ years +&quot; ) )) T &quot;);</span><br><span class="line">    mapSql += sqs.toString();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">List&lt;Object[]&gt; _querylist = genericDao.getDataWithNativeSql(mapSql);</span><br><span class="line"></span><br><span class="line">StringBuffer bf = new StringBuffer();</span><br><span class="line"></span><br><span class="line">if (_querylist.size() &gt; 0) &#123;</span><br><span class="line"> for(int i = 0; i &lt; _querylist.size(); i++) &#123;</span><br><span class="line">  Object[] obj = (Object[]) _querylist.get(i);</span><br><span class="line">  int size = _listTabYear.size();</span><br><span class="line">  bf.append(&quot;&#123;codeName:&apos;&quot;+obj[0]+&quot;&apos;,&quot;);</span><br><span class="line">  bf.append(&quot;gdpName:&apos;&quot;+obj[1]+&quot;&apos;,&quot;);</span><br><span class="line"></span><br><span class="line">  for(int t = 0; t &lt; size; t++)&#123;</span><br><span class="line">   Object[]  tempObj = _listTabYear.get(t);</span><br><span class="line">   bf.append(tempObj[0] + &quot;:&apos;&quot;+obj[t+2]+&quot;&apos;&quot;);</span><br><span class="line">   if(t == size - 1)&#123;</span><br><span class="line">    bf.append(&quot;&#125;&quot;);</span><br><span class="line">   &#125;</span><br><span class="line">   bf.append(&quot;,&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> return &quot;&#123;success : true, gridData : [&quot; + bf.substring(0, bf.length() -1) + &quot;], fieldsCode : [&quot;+years+&quot;]&#125;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Marico">
          <p class="site-author-name" itemprop="name">Marico</p>
          <p class="site-description motion-element" itemprop="description">Front-End Developer</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">21</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/mayue2015" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://stackoverflow.com/users/5566587/marico" target="_blank" title="Stack Overflow">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Stack Overflow
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/2089711385?is_all=1" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/MaYueMarico" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Marico</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"marico-mayue"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  

</body>
</html>
